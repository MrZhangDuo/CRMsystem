<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>我的商机</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="/lib/layui-v2.5.5/css/layui.css" media="all">
    <link rel="stylesheet" href="/css/public.css" media="all">

</head>
<style type="text/css">
    /* 文本框样式设置*/
    .layui-input-block {
        width: 600px;
        height:30px;
        margin-left: 700px;
    }

    #rese{
        margin: 0px auto;
        width: 200px;
        margin-left: 400px;
    }
    #chazhao{
        margin: 0px auto;
        width: 200px;
        margin-left: 50px;
    }



</style>

<body>
<div class="layuimini-container">
    <fieldset class="table-search-fieldset">
        <legend>搜索信息</legend>
        <form class="layui-form layui-form-pane">
            <div class="layui-inline">
                <div class="layui-input-inline">
                    <input type="text" name="busName" lay-verify="title" autocomplete="off" placeholder="请输入商机全称" class="layui-input">
                </div>
                <div class="layui-input-inline">
                    <input type="text" name="busStage" lay-verify="title" autocomplete="off" placeholder="请输入商机阶段" class="layui-input">
                </div>

                <div class="layui-input-inline">
                    <input type="text" name="busDutyPeople" lay-verify="title" autocomplete="off" placeholder="请输入商机负责人" class="layui-input">
                </div>
            </div>

            <div class="layui-inline">
                <div class="layui-input-inline">
                    <input type="text" name="busDept" lay-verify="title" autocomplete="off" placeholder="请输入所属部门" class="layui-input">
                </div>
                <div class="layui-input-inline">
                    <input type="text" name="busBeforeMoney" lay-verify="title" autocomplete="off" placeholder="请输入预计成交金额" class="layui-input">
                </div>
                <div class="layui-input-inline">
                    <input type="date" name="busBeforedate" lay-verify="title" autocomplete="off" placeholder="请输入预计结单日期" class="layui-input">
                </div>
            </div>
            <div>
                <input type="reset" class="layui-btn layui-btn-normal" lay-filter="data-search-btn" id="rese"></input>
                <button type="submit" class="layui-btn layui-btn-normal"  lay-filter="data-search-btn" id="chazhao">查找商机</button>
            </div>
        </form>
    </fieldset>

    <div class="layui-col-md3">
        <div class="layui-card">
            <div class="layui-card-header">
                <i class="fa fa-bullhorn icon icon-tip"></i>
                分类
            </div>
            <div class="layui-card-body layui-text">
                <div class="layuimini-notice">
                    <div class="layuimini-notice-title">所有分类</div>
                </div>
                <div class="layuimini-notice">
                    <div class="layuimini-notice-title">
                        <a herf="javascript:void(0);" id="myResponsibleBus">我负责的商机</a>
                        <span class="layui-badge layui-bg-blue" id="myResponsibleBusValue"></span>
                    </div>
                </div>
                <div class="layuimini-notice">
                    <div class="layuimini-notice-title">
                        <a herf="javascript:void(0);" id="myjoinBus">我参与的商机</a>
                        <span class="layui-badge layui-bg-blue" id="myjoinBusValue"></span>
                    </div>
                </div>
                <div class="layuimini-notice">
                    <div class="layuimini-notice-title">
                        <a herf="javascript:void(0);" id="myCareBus">我关注的商机</a>
                        <span class="layui-badge layui-bg-blue" id="myCareBusValue"></span>
                    </div>
                </div>

                <div class="layuimini-notice">
                    <div class="layuimini-notice-title">
                        <a herf="javascript:void(0);" id="proceedBus">进行中的商机</a>
                        <span class="layui-badge layui-bg-blue" id="proceedBusValue"></span>
                    </div>
                </div>
                <div class="layuimini-notice">
                    <div class="layuimini-notice-title">
                        <a herf="javascript:void(0);" id="Seven">7天未跟单</a>
                        <span class="layui-badge layui-bg-blue" id="SevenValue"></span>
                    </div>
                </div>
                <div class="layuimini-notice">
                    <div class="layuimini-notice-title">
                        <a herf="javascript:void(0);" id="Thirty"> 30天未跟单</a>
                        <span class="layui-badge layui-bg-blue" id="ThirtyValue"></span>
                    </div>
                </div>
                <div class="layuimini-notice">
                    <div class="layuimini-notice-title">
                        <a herf="javascript:void(0);" id="Ninety"> 90天未跟单</a>
                        <span class="layui-badge layui-bg-blue" id="NinetyValue"></span>
                    </div>
                </div>
            </div>
        </div>
        <div class="layui-card">
            <div class="layui-card-body layui-text">
                <div class="layuimini-notice">
                    <div class="layuimini-notice-title">
                        <a herf="javascript:void(0);" id="week"> 本周新增</a>
                        <span class="layui-badge layui-bg-blue" id="weekValue"></span>
                    </div>
                </div>
                <div class="layuimini-notice">
                    <div class="layuimini-notice-title">
                        <a herf="javascript:void(0);" id="lastWeek"> 上周新增</a>
                        <span class="layui-badge layui-bg-blue" id="lastWeekValue"></span>
                    </div>
                </div>
                <div class="layuimini-notice">
                    <div class="layuimini-notice-title">
                        <a herf="javascript:void(0);" id="month"> 本月新增</a>
                        <span class="layui-badge layui-bg-blue" id="monthValue"></span>
                    </div>
                </div>
                <div class="layuimini-notice">
                    <div class="layuimini-notice-title">
                        <a herf="javascript:void(0);" id="lastMonth"> 上月新增</a>
                        <span class="layui-badge layui-bg-blue" id="lastMonthValue"></span>
                    </div>
                </div>
                <div class="layuimini-notice">
                    <div class="layuimini-notice-title">
                        <a herf="javascript:void(0);" id="quarter"> 本季度新增</a>
                        <span class="layui-badge layui-bg-blue" id="quarterValue"></span>
                    </div>
                </div>
                <div class="layuimini-notice">
                    <div class="layuimini-notice-title">
                        <a herf="javascript:void(0);" id="lastQuarter"> 上季度新增</a>
                        <span class="layui-badge layui-bg-blue" id="lastQuarterValue"></span>
                    </div>
                </div>
            </div>
        </div>
        <div class="layui-card">
            <div class="layui-card-body layui-text">
                <div class="layuimini-notice">
                    <div class="layuimini-notice-title">
                        <a herf="javascript:void(0);" id="traded"> 已成交的商机</a>
                        <span class="layui-badge layui-bg-blue" id="tradedValue"></span>
                    </div>
                </div>
                <div class="layuimini-notice">
                    <div class="layuimini-notice-title">
                        <a herf="javascript:void(0);" id="throw"> 已丢单的商机</a>
                        <span class="layui-badge layui-bg-blue" id="throwValue"></span>
                    </div>
                </div>
                <div class="layuimini-notice">
                    <div class="layuimini-notice-title">
                        <a herf="javascript:void(0);" id="shelve"> 已搁置的商机</a>
                        <span class="layui-badge layui-bg-blue" id="shelveValue"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="layui-col-md-offset3">
        <script type="text/html" id="toolbarDemo">
            <div class="layui-btn-container">
                <button class="layui-btn layui-btn-sm data-add-btn" lay-event="add"> 添加商机 </button>
                <button class="layui-btn layui-btn-sm layui-btn-danger data-delete-btn" lay-event="delete"> 刷新 </button>
            </div>
        </script>

        <table class="layui-hide" id="currentTableId" lay-filter="currentTableFilter"></table>
    </div>
</div>
<script src="/lib/layui-v2.5.5/layui.js" charset="utf-8"></script>
<script>
    layui.use(['form', 'table','jquery'], function () {
        var $ = layui.jquery,
            form = layui.form,
            table = layui.table;
        table.render({
            elem: '#currentTableId',
            toolbar: '#toolbarDemo'
            ,page: true //开启分页
            ,url: '/business/MyBusInfo.do' //数据接口
            ,type:'get'
            ,cols: [[
                {field: 'busName', width: 250, title: '商机名称',templet:'<div><a  href="/business/custByBusId.do?busId={{d.busId}}" class="layui-table-link">{{d.busName}}</a></div>'},
                {field: 'busStage', width: 180, title: '商机阶段'},
                {field: 'busBeforeMoney', width: 130, title: '预计成交金额'},
                {field: 'busDutyPeople', width: 180, title: '商机负责人'},
                {field: 'docId', width: 130, title: '最后跟单',templet:'<div><a  href="  " class="layui-table-link">{{d.docId}}</a></div>'},
                {field: 'invitationId', width: 130, title: '讨论版',templet:'<div><a  href="  " class="layui-table-link">{{d.invitationId==null?0:d.invitationId}}</a></div>'},
            ]]
        });

        /*根据id渲染表格*/
        $("#myResponsibleBus").click(function(){
            table.render({
                elem: '#currentTableId',
                toolbar: '#toolbarDemo'
                ,page: true //开启分页
                ,url: '/business/MyBusInfoByResponsiblePeople.do' //数据接口
                ,type:'get'
                ,cols: [[
                    {field: 'busName', width: 250, title: '商机名称',templet:'<div><a  href="  " class="layui-table-link">{{d.busName}}</a></div>'},
                    {field: 'busStage', width: 180, title: '商机阶段'},
                    {field: 'busBeforeMoney', width: 130, title: '预计成交金额'},
                    {field: 'busDutyPeople', width: 180, title: '商机负责人'},
                    {field: 'docId', width: 130, title: '最后跟单',templet:'<div><a  href="  " class="layui-table-link">{{d.docId}}</a></div>'},
                    {field: 'invitationId', width: 130, title: '讨论版',templet:'<div><a  href="  " class="layui-table-link">{{d.invitationId==null?0:d.invitationId}}</a></div>'},
                ]]
            });
        });
        $("#myjoinBus").click(function(){
            table.render({
                elem: '#currentTableId',
                toolbar: '#toolbarDemo'
                ,page: true //开启分页
                ,url: '/business/MyBusInfoByJoinPeople.do' //数据接口
                ,type:'get'
                ,cols: [[
                    {field: 'busName', width: 250, title: '商机名称',templet:'<div><a  href="  " class="layui-table-link">{{d.busName}}</a></div>'},
                    {field: 'busStage', width: 180, title: '商机阶段'},
                    {field: 'busBeforeMoney', width: 130, title: '预计成交金额'},
                    {field: 'busDutyPeople', width: 180, title: '商机负责人'},
                    {field: 'docId', width: 130, title: '最后跟单',templet:'<div><a  href="  " class="layui-table-link">{{d.docId}}</a></div>'},
                    {field: 'invitationId', width: 130, title: '讨论版',templet:'<div><a  href="  " class="layui-table-link">{{d.invitationId==null?0:d.invitationId}}</a></div>'},
                ]]
            });
        });
        $("#myCareBus").click(function(){
            table.render({
                elem: '#currentTableId',
                toolbar: '#toolbarDemo'
                ,page: true //开启分页
                ,url: '/business/MyBusInfoByCarePeople.do' //数据接口
                ,type:'get'
                ,cols: [[
                    {field: 'busName', width: 250, title: '商机名称',templet:'<div><a  href="  " class="layui-table-link">{{d.busName}}</a></div>'},
                    {field: 'busStage', width: 180, title: '商机阶段'},
                    {field: 'busBeforeMoney', width: 130, title: '预计成交金额'},
                    {field: 'busDutyPeople', width: 180, title: '商机负责人'},
                    {field: 'docId', width: 130, title: '最后跟单',templet:'<div><a  href="  " class="layui-table-link">{{d.docId}}</a></div>'},
                    {field: 'invitationId', width: 130, title: '讨论版',templet:'<div><a  href="  " class="layui-table-link">{{d.invitationId==null?0:d.invitationId}}</a></div>'},
                ]]
            });
        });


        /*ajax异步提交，根据id给对应的徽章赋值*/
        $.ajax({
            url:'/business/BusResponsiblePeopleNumber.do',
            method:'get',
            dataType:'JSON',
            success:function(res) {
                $("#myResponsibleBusValue").append(res);
            }
        }) ;
        $.ajax({
            url:'/business/BusJoinPeopleNumber.do',
            method:'get',
            dataType:'JSON',
            success:function(res) {
                $("#myjoinBusValue").append(res);
            }
        }) ;
        $.ajax({
            url:'/business/BusCarePeopleNumber.do',
            method:'get',
            dataType:'JSON',
            success:function(res) {
                $("#myCareBusValue").append(res);
            }
        }) ;

    });
</script>
</body>
</html>